# Исправление проблемы: праздники и выходные не отображаются

## Проблема

Праздники и кастомные выходные не отображаются в приложении, хотя данные правильно сохранены в Supabase (11 праздников, 6 выходных).

## Причина

В базе данных Supabase остались **старые записи настроек** (17 записей), которые не были удалены. Хотя код загружает только запись с `key='main'`, эти старые записи могут вызывать проблемы или указывать на неполное обновление данных.

## Решение

### Шаг 1: Удалить старые записи через SQL

1. Откройте [Supabase Dashboard](https://supabase.com/dashboard)
2. Перейдите в **SQL Editor**
3. Выполните SQL запрос:

```sql
DELETE FROM settings WHERE key != 'main';
```

4. Проверьте результат:

```sql
SELECT key FROM settings;
```

Должна остаться только одна запись с `key = 'main'`.

### Шаг 2: Очистить кеш браузера

После удаления старых записей:

1. Откройте DevTools (F12 или Cmd+Option+I)
2. Откройте вкладку **Application** (или **Хранилище**)
3. Нажмите **Clear site data** (или "Очистить данные сайта")
4. Или используйте **Hard Reload**: Cmd+Shift+R (Mac) / Ctrl+Shift+R (Windows)

### Шаг 3: Проверить логи

Откройте консоль браузера (F12) и проверьте логи:

- Должны быть сообщения `[api-client] Settings loaded` с информацией о количестве праздников и выходных
- Не должно быть ошибок `Failed to parse setting currency` или подобных

### Шаг 4: Проверить данные

В консоли браузера выполните:

```javascript
// Проверить загруженные настройки
const settings = window.__ZUSTAND_STORE__?.getState?.()?.settings;
// Или через React DevTools найти useSettingsStore и проверить settings.holidays
```

## Дополнительная проверка

Если проблема сохраняется, проверьте данные напрямую:

```bash
cd /Users/rafael/crm-desktop
node scripts/check-settings.mjs
```

Должна быть только одна запись с `key='main'` и правильными данными (11 праздников, 6 выходных).

## Если ничего не помогает

1. Выполните полную миграцию настроек заново:
   ```bash
   ./run-migration.sh fix-settings
   ```

2. Убедитесь, что в браузере загружается последняя версия кода (проверьте, что Vercel развернул последний коммит)

3. Проверьте переменные окружения в Vercel (`VITE_SUPABASE_URL` и `VITE_SUPABASE_ANON_KEY`)
